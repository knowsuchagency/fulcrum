name: PR Notification

on:
  pull_request:
    types: [opened, reopened]
    branches:
      - main

jobs:
  notify:
    name: Send Pushover Notification
    runs-on: ubuntu-latest
    steps:
      - name: Send Pushover notification
        env:
          PUSHOVER_TOKEN: ${{ secrets.PUSHOVER_APP_TOKEN }}
          PUSHOVER_USER: ${{ secrets.PUSHOVER_USER_KEY }}
        run: |
          curl -s \
            --form-string "token=$PUSHOVER_TOKEN" \
            --form-string "user=$PUSHOVER_USER" \
            --form-string "title=PR Opened: ${{ github.event.pull_request.title }}" \
            --form-string "message=${{ github.event.pull_request.user.login }} opened PR #${{ github.event.pull_request.number }}" \
            --form-string "url=${{ github.event.pull_request.html_url }}" \
            --form-string "url_title=View PR" \
            https://api.pushover.net/1/messages.json
